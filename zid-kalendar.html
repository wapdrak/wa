<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>≈Ωidovsk√Ω kalend√°≈ô - Local Edition</title>
    <style>
        /**
         * DESIGN: Fialov√Ω styl a scannabilita [cite: 2025-09-15]
         */
        :root {
            --bg: #0f0a1a;
            --card: #2e1a47; 
            --accent: #bb86fc;
            --text: #ffffff;
            --muted: #d1c4e9;
        }
        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 15px;
        }
        #q-cont {
            width: 100%;
            max-width: 550px;
            background: var(--card);
            border: 3px solid var(--accent);
            border-radius: 35px;
            padding: 35px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.7);
            text-align: center;
        }
        .header { font-size: 0.9em; letter-spacing: 3px; text-transform: uppercase; color: var(--accent); margin-bottom: 5px; }
        .misto-label { font-size: 1.1em; color: var(--accent); margin-bottom: 5px; display: block; opacity: 0.8; }
        .gregorian-date { font-size: 1.2em; color: var(--muted); margin-bottom: 15px; font-weight: 300; }
        .jom-tyden { font-size: 1.7em; font-weight: 300; margin-bottom: 20px; opacity: 0.9; }
        .hebrew-date { font-size: clamp(2.2em, 8vw, 3em); font-weight: 800; margin: 10px 0; line-height: 1.1; }
        .hebrew-script { font-size: 2em; color: var(--accent); margin-bottom: 20px; font-family: 'Times New Roman', serif; }
        .section-label { font-size: 1.1em; color: var(--accent); font-weight: bold; margin-top: 25px; display: block; }
        .detail-text { font-size: 1.3em; line-height: 1.5; color: var(--muted); font-style: italic; margin-top: 5px; }
        .explanation { margin-top: 30px; padding: 20px; border: 1px solid rgba(187, 134, 252, 0.3); border-radius: 20px; color: var(--accent); font-size: 1.1em; line-height: 1.4; background: rgba(0,0,0,0.2); }
        #custom-msg { width: 100%; background: rgba(15, 10, 26, 0.5); border: 1px solid var(--accent); border-radius: 15px; color: white; padding: 12px; margin-top: 10px; resize: none; box-sizing: border-box; font-family: inherit; font-size: 1em; }
        .share-btn { margin-top: 25px; background: var(--accent); color: #0f0a1a; border: none; padding: 20px; border-radius: 50px; font-size: 1.2em; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s; }
        .share-btn:active { transform: scale(0.98); opacity: 0.8; }
    </style>
</head>
<body>

    <div id="q-cont">
        <div class="header">≈Ωidovsk√Ω kalend√°≈ô</div>
        <div class="misto-label" id="misto-txt">Naƒç√≠t√°m...</div>
        <div class="gregorian-date" id="g-date-txt">--. --. ----</div>
        <div class="jom-tyden" id="jom-txt">-- (--)</div>
        
        <div class="hebrew-date" id="h-date-txt">--. -- ----</div>
        <div class="hebrew-script" id="h-script-txt">-- ◊ë÷¥÷º◊©÷∞◊Å◊ë÷∏◊ò --</div>
        
        <span class="section-label">üìñ Para≈°at Ha≈†avua:</span>
        <div class="detail-text" id="parasha-txt">Naƒç√≠t√°m...</div>
        
        <span class="section-label">‚ú® Sv√°tek / Ud√°lost:</span>
        <div class="detail-text" id="event-txt">Dnes nen√≠ ≈æ√°dn√Ω v√Ωznamn√Ω sv√°tek.</div>
        
        <div class="explanation" id="expl-txt">
            Datum se mƒõn√≠ s v√Ωchodem prvn√≠ hvƒõzdy (Tzeit HaKochavim) v dan√© lokalitƒõ.
        </div>

        <textarea id="custom-msg" rows="2">Pos√≠l√°m pozdravy z Haify! üáÆüá±</textarea>
        <button class="share-btn" onclick="shareJewishDay()">Sd√≠let datum üáÆüá±</button>
    </div>

    <script>
        /**
         * 1. DATA A LOKALITY [cite: 2026-01-13]
         */
        const LOKALITY = {
            "Haifa":      { lat: 32.79, lng: 34.99, tz: 120, label: "Haifa, Izrael üáÆüá±" },
            "Jeruzalem":  { lat: 31.76, lng: 35.21, tz: 120, label: "Jeruzal√©m, Izrael üáÆüá±" },
            "Praha":      { lat: 50.07, lng: 14.43, tz: 60,  label: "Praha, ƒåesko üá®üáø" },
            "Bratislava": { lat: 48.14, lng: 17.10, tz: 60,  label: "Bratislava, Slovensko üá∏üá∞" }
        };

        const dnyPhonetic = ["Jom ri≈°on (Nedƒõle)", "Jom ≈°eni (Pondƒõl√≠)", "Jom ≈°li≈°i (√öter√Ω)", "Jom revi'i (St≈ôeda)", "Jom chami≈°i (ƒåtvrtek)", "Jom ≈°i≈°i (P√°tek)", "≈†abat (Sobota)"];
        const vsechnyParashot = ["Bere≈°it", "Noach", "Lech Lecha", "Vajera", "Chajej S√°ra", "Toledot", "Vajece", "Vaji≈°lach", "Vaje≈°ev", "Mikec", "Vajiga≈°", "Vajechi", "≈†emot", "Va'era", "Bo", "Be≈°alach", "Jitro", "Mi≈°patim", "Teruma", "Tecave", "Ki tisa", "Vajakhel", "Pekudej", "Vajikra", "Caw", "≈†mini", "Tazria", "Mecora", "Acharej Mot", "Kedo≈°im", "Emor", "Behar", "Bechukotaj", "Bemidbar", "Naso", "Beha'alotecha", "≈†lach Lecha", "Korach", "Chukat", "Balak", "Pinchas", "Matot", "Masej", "Devarim", "Va'etchanan", "Ekev", "Re'e", "Shoftim", "Ki tece", "Ki tavo", "Nicavim", "Vajelech", "Ha'azinu", "Ve-zot ha-beracha"];
        const mesHeCz = {"Shevat":"≈†vat", "Adar I":"Adar I", "Adar II":"Adar II", "Nisan":"Nisan", "Iyar":"Ijar", "Sivan":"Sivan", "Tamuz":"Tamuz", "Av":"Av", "Elul":"Elul", "Tishri":"Ti≈°rej", "Cheshvan":"Che≈°van", "Kislev":"Kislev", "Tevet":"Tevet"};

        /**
         * 2. ASTRONOMICK√â V√ùPOƒåTY [cite: 2026-01-13]
         */
        function getTzeitMinutes(date, conf) {
            const dayOfYear = Math.floor((date - new Date(date.getFullYear(), 0, 0)) / 86400000);
            const decl = 0.409 * Math.sin(2 * Math.PI * (dayOfYear - 81) / 365);
            const sunsetH = 12 + (Math.acos(-Math.tan(conf.lat * Math.PI / 180) * Math.tan(decl)) * 180 / Math.PI) / 15;
            const isDST = date.getMonth() > 2 && date.getMonth() < 9 ? 60 : 0;
            return (sunsetH * 60) + conf.tz + isDST + 35; // +35 min pro hvƒõzdy
        }

        /**
         * 3. INICIALIZACE A LOGIKA ODDƒöLEN√ç DAT [cite: 2025-12-27, 2026-01-13]
         */
        function init() {
            const params = new URLSearchParams(window.location.search);
            const mistoParam = params.get('misto');
            const conf = LOKALITY[mistoParam] || LOKALITY["Haifa"];
            
            document.getElementById('misto-txt').innerText = conf.label;

            let d_civil = new Date(); // Re√°ln√Ω aktu√°ln√≠ ƒças [cite: 2025-12-27]
            let d_zid = new Date();   // ƒåas pro v√Ωpoƒçet ≈æidovsk√©ho data [cite: 2025-12-27]

            const nyniMin = (d_civil.getHours() * 60) + d_civil.getMinutes();
            const tzeitMin = getTzeitMinutes(d_civil, conf);

            // POSUN: Pouze ≈æidovsk√© datum se mƒõn√≠ po v√Ωchodu hvƒõzd [cite: 2026-01-13]
            if (nyniMin >= tzeitMin) {
                d_zid.setDate(d_zid.getDate() + 1);
            }

            // GREGORI√ÅNSK√â DATUM: V≈ædy re√°ln√Ω kalend√°≈ôn√≠ den [cite: 2025-12-27]
            const gOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('g-date-txt').innerText = d_civil.toLocaleDateString('cs-CZ', gOptions);

            // FONETICK√ù DEN (z d_zid, aby po z√°padu byla u≈æ "st≈ôeda") [cite: 2026-01-13]
            document.getElementById('jom-txt').innerText = dnyPhonetic[d_zid.getDay()];

            // HEBREJSK√â DATUM [cite: 2025-12-27]
            const hFormat = new Intl.DateTimeFormat('en-u-ca-hebrew', {day:'numeric', month:'long', year:'numeric'});
            const hParts = hFormat.formatToParts(d_zid);
            const hScript = new Intl.DateTimeFormat('he-u-ca-hebrew', {day:'numeric', month:'long', year:'numeric'}).format(d_zid);
            
            let hDen, hMesEn, hRok;
            hParts.forEach(p => {
                if (p.type === 'day') hDen = parseInt(p.value);
                if (p.type === 'month') hMesEn = p.value;
                if (p.type === 'year') hRok = p.value;
            });

            document.getElementById('h-date-txt').innerText = `${hDen}. ${mesHeCz[hMesEn] || hMesEn} ${hRok}`;
            document.getElementById('h-script-txt').innerText = hScript;

            // SV√ÅTEK [cite: 2025-09-14]
            let svatek = "Dnes nen√≠ ≈æ√°dn√Ω v√Ωznamn√Ω sv√°tek.";
            if (hMesEn === "Shevat" && hDen === 15) svatek = "Tu bi-≈°vat üå≥";
            else if (hMesEn.includes("Adar") && hDen === 14) svatek = "Purim üé≠";
            document.getElementById('event-txt').innerText = svatek;

            // PARA≈†A [cite: 2025-12-27]
            let sabat = new Date(d_zid);
            while (sabat.getDay() !== 6) sabat.setDate(sabat.getDate() + 1);
            const startRoku = new Date(d_zid.getFullYear(), 0, 1);
            const tydenRoku = Math.ceil((((sabat - startRoku) / 86400000) + startRoku.getDay() + 1) / 7);
            document.getElementById('parasha-txt').innerText = vsechnyParashot[(tydenRoku + 13) % vsechnyParashot.length];
        }

        /**
         * 4. SD√çLEN√ç [cite: 2025-12-29]
         */
        function shareJewishDay() {
            const text = `üáÆüá± ${document.getElementById('misto-txt').innerText}\nüìÖ Gregori√°nsky: ${document.getElementById('g-date-txt').innerText}\n‚ú® ≈Ωidovsky: ${document.getElementById('jom-txt').innerText}\nüìú ${document.getElementById('h-date-txt').innerText}\nüìñ Para≈°a: ${document.getElementById('parasha-txt').innerText}\nüí¨ ${document.getElementById('custom-msg').value}`;
            if (navigator.share) navigator.share({ text: text }); else alert(text);
        }

        window.onload = init;
    </script>
</body>
</html>
