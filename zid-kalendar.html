<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Å½idovskÃ½ kalendÃ¡Å™ - Haifa Edition</title>
    <style>
        :root { --bg: #0f0a1a; --card: #2e1a47; --accent: #bb86fc; --text: #ffffff; --muted: #d1c4e9; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 15px; }
        #q-cont { width: 100%; max-width: 550px; background: var(--card); border: 3px solid var(--accent); border-radius: 35px; padding: 35px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.7); }
        .header { font-size: 0.9em; letter-spacing: 3px; color: var(--accent); text-transform: uppercase; margin-bottom: 5px; }
        .jom-tyden { font-size: 1.7em; font-weight: 300; margin-bottom: 20px; opacity: 0.8; }
        .hebrew-date { font-size: clamp(2em, 8vw, 2.8em); font-weight: 800; margin: 10px 0; line-height: 1.1; }
        .hebrew-script { font-size: 2em; color: var(--accent); font-family: 'Times New Roman', serif; margin-bottom: 20px; }
        .section-label { font-size: 1.1em; color: var(--accent); font-weight: bold; margin-top: 25px; display: block; }
        .detail-text { font-size: 1.3em; color: var(--muted); font-style: italic; margin-top: 5px; }
        .parasha-link { color: var(--accent); text-decoration: none; border-bottom: 1px dashed var(--accent); }
        .explanation { margin-top: 30px; padding: 20px; border: 1px solid rgba(187, 134, 252, 0.3); border-radius: 20px; color: var(--accent); background: rgba(0,0,0,0.2); font-size: 1.1em; line-height: 1.4; }
        #custom-msg { width: 100%; background: rgba(15, 10, 26, 0.5); border: 1px solid var(--accent); border-radius: 15px; color: white; padding: 12px; margin-top: 5px; resize: none; box-sizing: border-box; }
        .share-btn { margin-top: 25px; background: var(--accent); color: #0f0a1a; border: none; padding: 20px; border-radius: 50px; font-size: 1.2em; font-weight: bold; cursor: pointer; width: 100%; }
    </style>
</head>
<body>
    <div id="q-cont">
        <div class="header">Å½idovskÃ½ kalendÃ¡Å™</div>
        <div class="jom-tyden" id="jom-txt">NaÄÃ­tÃ¡m...</div>
        <div class="hebrew-date" id="h-date-txt">--. -- ----</div>
        <div class="hebrew-script" id="h-script-txt">-- ×‘Ö´Ö¼×©Ö°××‘Ö¸×˜ --</div>
        <span class="section-label">ğŸ“– ParaÅ¡at HaÅ avua:</span>
        <div class="detail-text">
            <a href="https://www.sefaria.org.il/topics/torah-portions" target="_blank" class="parasha-link" id="parasha-txt">NaÄÃ­tÃ¡m...</a>
        </div>
        <span class="section-label">âœ¨ SvÃ¡tek / UdÃ¡lost:</span>
        <div class="detail-text" id="event-txt">Dnes nenÃ­ Å¾Ã¡dnÃ½ vÃ½znamnÃ½ svÃ¡tek.</div>
        <div class="explanation">Datum se mÄ›nÃ­ s vÃ½chodem prvnÃ­ hvÄ›zdy (Tzeit HaKochavim) v HaifÄ›, coÅ¾ znamenÃ¡ Å¾e novÃ½ den zaÄÃ­nÃ¡ jiÅ¾ veÄer.</div>
        <textarea id="custom-msg" rows="2">PosÃ­lÃ¡m pozdravy z Haify! ğŸ‡®ğŸ‡±</textarea>
        <button class="share-btn" onclick="shareJewishDay()">SdÃ­let datum ğŸ‡®ğŸ‡±</button>
    </div>

    <script>
        const dnyHeCz = ["Jom riÅ¡on (NedÄ›le)", "Jom Å¡eni (PondÄ›lÃ­)", "Jom Å¡liÅ¡i (ÃšterÃ½)", "Jom revi'i (StÅ™eda)", "Jom chamiÅ¡i (ÄŒtvrtek)", "Jom Å¡iÅ¡i (PÃ¡tek)", "Å abat (Sobota / Å Ã¡bes)"];
        const mesHeCz = {"Shevat":"Å vat", "Adar I":"Adar I", "Adar II":"Adar II", "Nisan":"Nisan", "Iyar":"Ijar", "Sivan":"Sivan", "Tamuz":"Tamuz", "Av":"Av", "Elul":"Elul", "Tishri":"TiÅ¡rej", "Cheshvan":"CheÅ¡van", "Kislev":"Kislev", "Tevet":"Tevet"};
        const svatky = {"2.2.2026":"Tu Bi-Å¡vat ğŸŒ³", "3.3.2026":"PÅ¯st Ester", "4.3.2026":"Purim ğŸ­", "1.4.2026":"Erev Pesach ğŸ·"};
        const parashot = {"14.2.2026":"Jitro (×™Ö´×ªÖ°×¨×•Ö¹)", "21.2.2026":"MiÅ¡patim (×Ö´×©Ö°××¤Ö¸Ö¼×˜Ö´×™×)", "28.2.2026":"Teruma (×ªÖ°Ö¼×¨×•Ö¼×Ö¸×”)"};

        function getTzeitMinutes(date) {
            const lat = 32.79, dayOfYear = Math.floor((date - new Date(date.getFullYear(), 0, 0)) / 86400000);
            const decl = 0.409 * Math.sin(2 * Math.PI * (dayOfYear - 81) / 365);
            const sunsetH = 12 + (Math.acos(-Math.tan(lat * Math.PI / 180) * Math.tan(decl)) * 180 / Math.PI) / 15;
            return (sunsetH * 60) + 35 + 120; // +35 min (hvÄ›zdy) + 120 (ÄasovÃ© pÃ¡smo Haifa)
        }

        function init() {
            let d = new Date();
            const currentMinutes = (d.getHours() * 60) + d.getMinutes();
            const tzeitMinutes = getTzeitMinutes(d);

            // KLÃÄŒOVÃ OPRAVA: Posun nastane jen VEÄŒER po Tzeit, ne rÃ¡no!
            if (currentMinutes >= tzeitMinutes) {
                d.setDate(d.getDate() + 1);
            }

            document.getElementById('jom-txt').innerText = dnyHeCz[d.getDay()];

            const hFormat = new Intl.DateTimeFormat('en-u-ca-hebrew', {day:'numeric', month:'long', year:'numeric'});
            const hParts = hFormat.formatToParts(d);
            const hScript = new Intl.DateTimeFormat('he-u-ca-hebrew', {day:'numeric', month:'long', year:'numeric'}).format(d);
            
            let den, mesEn, rok;
            hParts.forEach(p => {
                if (p.type === 'day') den = p.value;
                if (p.type === 'month') mesEn = p.value;
                if (p.type === 'year') rok = p.value;
            });

            document.getElementById('h-date-txt').innerText = `${den}. ${mesHeCz[mesEn] || mesEn} ${rok}`;
            document.getElementById('h-script-txt').innerText = hScript;

            let sabat = new Date(d);
            while(sabat.getDay() !== 6) sabat.setDate(sabat.getDate() + 1);
            const klic = `${sabat.getDate()}.${sabat.getMonth() + 1}.${sabat.getFullYear()}`;
            document.getElementById('parasha-txt').innerText = parashot[klic] || "ParaÅ¡a bude doplnÄ›na.";

            const dKlic = `${d.getDate()}.${d.getMonth() + 1}.${d.getFullYear()}`;
            document.getElementById('event-txt').innerText = svatky[dKlic] || "Dnes nenÃ­ Å¾Ã¡dnÃ½ vÃ½znamnÃ½ svÃ¡tek.";
        }

        function shareJewishDay() {
            const msg = `ğŸ‡®ğŸ‡± Å½idovskÃ½ kalendÃ¡Å™\n\n${document.getElementById('jom-txt').innerText}\n${document.getElementById('h-date-txt').innerText}\n${document.getElementById('h-script-txt').innerText}\n\n${document.getElementById('custom-msg').value}`;
            if (navigator.share) navigator.share({ text: msg }); else alert(msg);
        }
        window.onload = init;
    </script>
</body>
</html>
