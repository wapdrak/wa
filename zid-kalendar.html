<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Å½idovskÃ½ kalendÃ¡Å™ - Local Independent Edition</title>
    <style>
        /**
         * DESIGN: FialovÃ½ styl a scannabilita [cite: 2025-09-15]
         */
        :root {
            --bg: #0f0a1a;
            --card: #2e1a47; 
            --accent: #bb86fc;
            --text: #ffffff;
            --muted: #d1c4e9;
        }
        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 15px;
        }
        #q-cont {
            width: 100%;
            max-width: 550px;
            background: var(--card);
            border: 3px solid var(--accent);
            border-radius: 35px;
            padding: 35px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.7);
            text-align: center;
        }
        .header { font-size: 0.9em; letter-spacing: 3px; text-transform: uppercase; color: var(--accent); margin-bottom: 5px; }
        .time-display { font-size: 1.2em; font-weight: bold; color: var(--text); margin-bottom: 10px; }
        .misto-label { font-size: 1.1em; color: var(--accent); margin-bottom: 15px; display: block; opacity: 0.8; font-weight: bold; }
        .g-label { font-size: 1em; color: var(--muted); margin-bottom: 2px; }
        .gregorian-date { font-size: 1.3em; color: var(--text); margin-bottom: 15px; font-weight: 400; }
        .jom-tyden { font-size: 1.7em; font-weight: 300; margin-bottom: 20px; color: var(--accent); }
        .hebrew-date { font-size: clamp(2.2em, 8vw, 3em); font-weight: 800; margin: 10px 0; line-height: 1.1; }
        .hebrew-script { font-size: 2em; color: var(--accent); margin-bottom: 20px; font-family: 'Times New Roman', serif; }
        .section-label { font-size: 1.1em; color: var(--accent); font-weight: bold; margin-top: 25px; display: block; }
        .detail-text { font-size: 1.3em; line-height: 1.5; color: var(--muted); font-style: italic; margin-top: 5px; }
        .parasha-link { color: var(--accent); text-decoration: none; border-bottom: 1px dashed var(--accent); }
        .explanation { margin-top: 30px; padding: 20px; border: 1px solid rgba(187, 134, 252, 0.3); border-radius: 20px; color: var(--accent); font-size: 1.1em; line-height: 1.4; background: rgba(0,0,0,0.2); }
        #custom-msg { width: 100%; background: rgba(15, 10, 26, 0.5); border: 1px solid var(--accent); border-radius: 15px; color: white; padding: 12px; margin-top: 10px; resize: none; box-sizing: border-box; font-family: inherit; font-size: 1em; }
        .share-btn { margin-top: 25px; background: var(--accent); color: #0f0a1a; border: none; padding: 20px; border-radius: 50px; font-size: 1.2em; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s; }
        .share-btn:active { transform: scale(0.98); opacity: 0.8; }
    </style>
</head>
<body>

    <div id="q-cont">
        <div class="header">Å½idovskÃ½ kalendÃ¡Å™</div>
        <div class="time-display" id="time-txt">00:00:00</div>
        <div class="misto-label" id="misto-txt">NaÄÃ­tÃ¡m...</div>
        
        <div class="g-label">ğŸ“… Dnes je:</div>
        <div class="gregorian-date" id="g-date-txt">--. --. ----</div>
        
        <div class="jom-tyden" id="jom-txt">âœ¨ NaÄÃ­tÃ¡m...</div>
        
        <div class="hebrew-date" id="h-date-txt">ğŸ“œ --. -- ----</div>
        <div class="hebrew-script" id="h-script-txt">-- ×‘Ö´Ö¼×©Ö°××‘Ö¸×˜ --</div>
        
        <span class="section-label">ğŸ“– ParaÅ¡at HaÅ avua:</span>
        <div class="detail-text">
            <a href="https://www.sefaria.org.il/topics/torah-portions?sort=Relevance&tab=sources" target="_blank" class="parasha-link" id="parasha-txt">NaÄÃ­tÃ¡m paraÅ¡u...</a>
        </div>
        
        <span class="section-label">âœ¨ SvÃ¡tek / UdÃ¡lost:</span>
        <div class="detail-text" id="event-txt">Dnes nenÃ­ Å¾Ã¡dnÃ½ vÃ½znamnÃ½ svÃ¡tek.</div>

        <span class="section-label">ğŸ•¯ï¸ ZapalovÃ¡nÃ­ svÃ­cÃ­:</span>
        <div class="detail-text" id="candles-txt">--:--</div>
        
        <div class="explanation" id="expl-txt">
            Datum se mÄ›nÃ­ s vÃ½chodem prvnÃ­ hvÄ›zdy (Tzeit HaKochavim) v danÃ© lokalitÄ›, takÅ¾e novÃ½ den zaÄÃ­nÃ¡ jiÅ¾ veÄer.
        </div>

        <textarea id="custom-msg" rows="2">PosÃ­lÃ¡m pozdravy z Haify! ğŸ‡®ğŸ‡±ğŸ‡¨ğŸ‡¿ğŸ‡¸ğŸ‡°</textarea>
        <button class="share-btn" onclick="shareJewishDay()">SdÃ­let datum</button>
    </div>

    <script>
        /**
         * 1. KONFIGURACE LOKALIT [cite: 2026-01-13]
         */
        const LOKALITY = {
            "Haifa":      { lat: 32.79, lng: 34.99, tz: 120, label: "Haifa, Izrael ğŸ‡®ğŸ‡±" },
            "Jeruzalem":  { lat: 31.76, lng: 35.21, tz: 120, label: "JeruzalÃ©m, Izrael ğŸ‡®ğŸ‡±" },
            "Praha":      { lat: 50.07, lng: 14.43, tz: 60,  label: "Praha, ÄŒesko ğŸ‡¨ğŸ‡¿" },
            "Bratislava": { lat: 48.14, lng: 17.10, tz: 60,  label: "Bratislava, Slovensko ğŸ‡¸ğŸ‡°" },
            "Chicago":    { lat: 41.87, lng: -87.62, tz: -360, label: "Chicago, USA ğŸ‡ºğŸ‡¸" },
            "NewYork":    { lat: 40.71, lng: -74.00, tz: -300, label: "New York, USA ğŸ‡ºğŸ‡¸" },
            "CedarRapids": { lat: 41.97, lng: -91.66, tz: -360, label: "Cedar Rapids, USA ğŸ‡ºğŸ‡¸" },
            "London":     { lat: 51.50, lng: -0.12, tz: 0,   label: "LondÃ½n, BritÃ¡nie ğŸ‡¬ğŸ‡§" },
            "Munchen":    { lat: 48.13, lng: 11.58, tz: 60,  label: "Mnichov, NÄ›mecko ğŸ‡©ğŸ‡ª" },
            "Wien":       { lat: 48.20, lng: 16.37, tz: 60,  label: "VÃ­deÅˆ, Rakousko ğŸ‡¦ğŸ‡¹" },
            "Toronto":    { lat: 43.65, lng: -79.38, tz: -300, label: "Toronto, Kanada ğŸ‡¨ğŸ‡¦" },
            "Melbourne":  { lat: -37.81, lng: 144.96, tz: 660, label: "Melbourne, AustrÃ¡lie ğŸ‡¦ğŸ‡º" }
        };

        const dnyPhonetic = ["Jom riÅ¡on (NedÄ›le)", "Jom Å¡eni (PondÄ›lÃ­)", "Jom Å¡liÅ¡i (ÃšterÃ½)", "Jom revi'i (StÅ™eda)", "Jom chamiÅ¡i (ÄŒtvrtek)", "Jom Å¡iÅ¡i (PÃ¡tek)", "Å abat (Sobota)"];
        const mesHeCz = {"Shevat":"Å vat", "Adar I":"Adar I", "Adar II":"Adar II", "Nisan":"Nisan", "Iyar":"Ijar", "Sivan":"Sivan", "Tamuz":"Tamuz", "Av":"Av", "Elul":"Elul", "Tishri":"TiÅ¡rej", "Cheshvan":"CheÅ¡van", "Kislev":"Kislev", "Tevet":"Tevet"};

        const capitalize = (s) => s.charAt(0).toUpperCase() + s.slice(1);

        /**
         * 2. ÄŒAS A VÃPOÄŒET HVÄšZD/SLUNCE
         */
        function updateClock() {
            document.getElementById('time-txt').innerText = new Date().toLocaleTimeString('cs-CZ');
        }

        function getSunset(date, conf) {
            const dayOfYear = Math.floor((date - new Date(date.getFullYear(), 0, 0)) / 86400000);
            const decl = 0.409 * Math.sin(2 * Math.PI * (dayOfYear - 81) / 365);
            const sunsetH = 12 + (Math.acos(-Math.tan(conf.lat * Math.PI / 180) * Math.tan(decl)) * 180 / Math.PI) / 15;
            const isDST = date.getTimezoneOffset() < 0 ? 60 : 0; // Detekce DST
            return (sunsetH * 60) + conf.tz + isDST;
        }

        /**
         * 3. NEZÃVISLÃ VÃPOÄŒET SVÃTKÅ® (StatickÃ¡ mapa a logika)
         */
        function getHoliday(hDay, hMonth, dayOfWeek) {
            // hMonth je anglickÃ½ nÃ¡zev z Intl
            const m = hMonth;
            const d = hDay;

            // PevnÃ© svÃ¡tky
            if (m === "Tishri" && d === 1) return "RoÅ¡ ha-Å¡ana (NovÃ½ rok)";
            if (m === "Tishri" && d === 2) return "RoÅ¡ ha-Å¡ana 2. den";
            if (m === "Tishri" && d === 10) return "Jom kipur (Den smÃ­Å™enÃ­)";
            if (m === "Tishri" && d >= 15 && d <= 21) return "Sukot (SvÃ¡tek stÃ¡nkÅ¯)";
            if (m === "Tishri" && d === 22) return "Å mini aceret / Simchat TÃ³ra";
            if (m === "Kislev" && d === 25) return "Chanuka (1. svÃ­Äka veÄer)";
            if (m === "Tevet" && d <= 2) return "Chanuka";
            if (m === "Shevat" && d === 15) return "Tu bi-Å¡vat (NovÃ½ rok stromÅ¯)";
            if ((m === "Adar" || m === "Adar II") && d === 14) return "Purim";
            if (m === "Nisan" && d >= 15 && d <= 22) return "Pesach (SvÃ¡tek nekvaÅ¡enÃ½ch chlebÅ¯)";
            if (m === "Iyar" && d === 18) return "Lag ba-omer";
            if (m === "Sivan" && d === 6) return "Å avuot (SvÃ¡tek tÃ½dnÅ¯)";
            if (m === "Av" && d === 9) return "TiÅ¡a be-av (PÅ¯st)";

            // Sobota
            if (dayOfWeek === 6) return "Å abat (SvatÃ½ odpoÄinek)";
            
            return "Dnes nenÃ­ Å¾Ã¡dnÃ½ vÃ½znamnÃ½ svÃ¡tek.";
        }

        /**
         * 4. INICIALIZACE A VÃPOÄŒTY
         */
        function init() {
            updateClock();
            setInterval(updateClock, 1000);

            const params = new URLSearchParams(window.location.search);
            const conf = LOKALITY[params.get('misto')] || LOKALITY["Haifa"];
            document.getElementById('misto-txt').innerText = conf.label;

            let d_civil = new Date();
            let d_zid = new Date();

            const nyniMin = (d_civil.getHours() * 60) + d_civil.getMinutes();
            const sunsetMin = getSunset(d_civil, conf);
            const tzeitMin = sunsetMin + 35; // Tzeit HaKochavim cca 35 min po zÃ¡padu

            // Pokud je po vÃ½chodu hvÄ›zd, v Å¾idovskÃ©m kalendÃ¡Å™i je uÅ¾ zÃ­tÅ™ek
            if (nyniMin >= tzeitMin) d_zid.setDate(d_zid.getDate() + 1);

            // ZapalovÃ¡nÃ­ svÃ­cÃ­ (18 minut pÅ™ed zÃ¡padem v pÃ¡tek)
            if (d_civil.getDay() === 5) {
                const candleMin = sunsetMin - 18;
                const h = Math.floor(candleMin / 60);
                const m = Math.floor(candleMin % 60);
                document.getElementById('candles-txt').innerText = `${h}:${m < 10 ? '0'+m : m}`;
            } else {
                document.getElementById('candles-txt').innerText = "Dnes se nesvÃ­tÃ­.";
            }

            // GregoriÃ¡nskÃ© datum
            document.getElementById('g-date-txt').innerText = capitalize(d_civil.toLocaleDateString('cs-CZ', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' }));
            document.getElementById('jom-txt').innerText = "âœ¨ " + dnyPhonetic[d_zid.getDay()];

            // HebrejskÃ© datum pomocÃ­ vestavÄ›nÃ©ho Intl (nezÃ¡vislÃ© na externÃ­m API)
            const hFormat = new Intl.DateTimeFormat('en-u-ca-hebrew', {day:'numeric', month:'long', year:'numeric'});
            const hParts = hFormat.formatToParts(d_zid);
            const hScript = new Intl.DateTimeFormat('he-u-ca-hebrew', {day:'numeric', month:'long', year:'numeric'}).format(d_zid);
            
            let hDen, hMesEn, hRok;
            hParts.forEach(p => {
                if (p.type === 'day') hDen = parseInt(p.value);
                if (p.type === 'month') hMesEn = p.value;
                if (p.type === 'year') hRok = p.value;
            });

            document.getElementById('h-date-txt').innerText = `ğŸ“œ ${hDen}. ${mesHeCz[hMesEn] || hMesEn} ${hRok}`;
            document.getElementById('h-script-txt').innerText = hScript;

            // SvÃ¡tek
            document.getElementById('event-txt').innerText = getHoliday(hDen, hMesEn, d_zid.getDay());

            // ParaÅ¡a (jednoduchÃ½ odhad tÃ½dne v roce)
            const vsechnyParashot = ["BereÅ¡it", "Noach", "Lech Lecha", "Vajera", "Chajej SÃ¡ra", "Toledot", "Vajece", "VajiÅ¡lach", "VajeÅ¡ev", "Mikec", "VajigaÅ¡", "Vajechi", "Å emot", "Va'era", "Bo", "BeÅ¡alach", "Jitro", "MiÅ¡patim", "Teruma", "Tecave", "Ki tisa", "Vajakhel", "Pekudej", "Vajikra", "Caw", "Å mini", "Tazria", "Mecora", "Acharej Mot", "KedoÅ¡im", "Emor", "Behar", "Bechukotaj", "Bemidbar", "Naso", "Beha'alotecha", "Å lach Lecha", "Korach", "Chukat", "Balak", "Pinchas", "Matot", "Masej", "Devarim", "Va'etchanan", "Ekev", "Re'e", "Shoftim", "Ki tece", "Ki tavo", "Nicavim", "Vajelech", "Ha'azinu", "Ve-zot ha-beracha"];
            let sabat = new Date(d_zid);
            while (sabat.getDay() !== 6) sabat.setDate(sabat.getDate() + 1);
            const startRoku = new Date(d_zid.getFullYear(), 0, 1);
            const tydenRoku = Math.ceil((((sabat - startRoku) / 86400000) + startRoku.getDay() + 1) / 7);
            document.getElementById('parasha-txt').innerText = vsechnyParashot[(tydenRoku + 13) % vsechnyParashot.length];
        }

        /**
         * 5. SDÃLENÃ [cite: 2025-12-29]
         */
        function shareJewishDay() {
            const params = new URLSearchParams(window.location.search);
            const conf = LOKALITY[params.get('misto')] || LOKALITY["Haifa"];
            const explVeta = "Datum se mÄ›nÃ­ s vÃ½chodem prvnÃ­ hvÄ›zdy (Tzeit HaKochavim) v danÃ© lokalitÄ›, takÅ¾e novÃ½ den zaÄÃ­nÃ¡ jiÅ¾ veÄer.";

            const text = `Å½idovskÃ½ kalendÃ¡Å™\n\n` +
                         `ğŸ“ ${conf.label}\n\n` +
                         `ğŸ•’ ÄŒas: ${document.getElementById('time-txt').innerText}\n` +
                         `ğŸ“… Dnes je:\n\n` +
                         `${document.getElementById('g-date-txt').innerText}\n` +
                         `${document.getElementById('jom-txt').innerText}\n\n` +
                         `${document.getElementById('h-date-txt').innerText}\n` +
                         `${document.getElementById('h-script-txt').innerText}\n\n` +
                         `ğŸ“– ParaÅ¡a: ${document.getElementById('parasha-txt').innerText}\n` +
                         `âœ¨ SvÃ¡tek: ${document.getElementById('event-txt').innerText}\n` +
                         `ğŸ•¯ï¸ SvÃ­ce: ${document.getElementById('candles-txt').innerText}\n\n` +
                         `https://www.sefaria.org.il/topics/torah-portions\n\n` +
                         `${explVeta}\n\n` +
                         `ğŸ’¬ ${document.getElementById('custom-msg').value}`;

            if (navigator.share) {
                navigator.share({ text: text });
            } else {
                alert("Text zkopÃ­rovÃ¡n do konzole.");
                console.log(text);
            }
        }

        window.onload = init;
    </script>
</body>
</html>
